<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>學測翻譯鷹架訓練營</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f8fafc; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        .slide-up { animation: slideUp 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .tab-active { border-bottom: 3px solid #16a34a; color: #15803d; font-weight: bold; background-color: #f0fdf4; }
        .tab-inactive { color: #64748b; hover:text-green-600; hover:bg-white; }
        .animate-pulse-slow { animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        .concept-card { transition: transform 0.2s; }
        .concept-card:hover { transform: translateY(-2px); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const levels = [
            {
                id: "level1",
                title: "第一關：基礎與形容詞子句",
                type: "exercise",
                desc: "重點：S+V骨架、後位修飾 (形容詞子句)",
                teaching: [
                    {
                        id: "t1-1",
                        chinese: "人類的想像和創意是科技進步最大的驅動力。",
                        guide: [
                            { 
                                title: "Step 1：抓出 S + V", 
                                tags: ["S+V"],
                                content: "忽略修飾語，抓出核心。主詞是「想像和創意」(兩個)，動詞是「是」。", 
                                tip: "主詞有兩個 (Imagination and Creativity)，動詞用複數 are。",
                                vocab: ["Imagination 想像", "Creativity 創意"],
                                part: "Human imagination and creativity are..." 
                            },
                            { 
                                title: "Step 2：時態與語態", 
                                tags: ["現在式"],
                                content: "這是一個事實陳述，使用「現在簡單式」。主動語態。", 
                                part: "...are..." 
                            },
                            { 
                                title: "Step 3：修飾語 (介系詞片語)", 
                                tags: ["後位修飾"],
                                content: "處理「科技進步的」驅動力。英文習慣把修飾語放在名詞後面。", 
                                tip: "用 'behind' (在...背後) 比 'of' 更精準。",
                                vocab: ["Driving force 驅動力", "Technological advancement 科技進步"],
                                part: "...the greatest driving force behind technological advancement." 
                            },
                            { 
                                title: "Step 4：組裝定稿", 
                                tags: ["完整句"],
                                content: "將骨架與修飾語結合。", 
                                part: "Human imagination and creativity are the greatest driving force behind technological advancement." 
                            }
                        ],
                        answer: "Human imagination and creativity are the greatest driving force behind technological advancement.",
                        analysis: "基礎的 S + V + C 結構，搭配介系詞片語做後位修飾。"
                    },
                    {
                        id: "t1-2",
                        chinese: "過去在科幻電影中出現的神奇物件，現在正逐一成真。",
                        guide: [
                            { 
                                title: "Step 1：抓出 S + V", 
                                tags: ["S+V", "主詞陷阱"],
                                content: "主詞是「物件」(Objects)，不是電影！動詞是「成真」(become reality)。", 
                                vocab: ["Magical objects 神奇物件"],
                                part: "Magical objects..." 
                            },
                            { 
                                title: "Step 2：時態與語態", 
                                tags: ["現在進行式"],
                                content: "看到「現在正...」，表示動作正在進行，用「現在進行式」(are becoming)。", 
                                vocab: ["Come true / Become reality 成真"],
                                part: "...are now becoming reality..." 
                            },
                            { 
                                title: "Step 3：修飾語 (形容詞子句)", 
                                tags: ["形容詞子句"],
                                content: "處理「[過去在科幻電影中出現的] 物件」。這是長的形容詞，要用形容詞子句 (that...) 放在物件後面。", 
                                tip: "結構：N + that + V... (that appeared in sci-fi movies)",
                                vocab: ["Sci-fi movies 科幻電影", "Appear 出現"],
                                part: "...that appeared in sci-fi movies in the past..." 
                            },
                            { 
                                title: "Step 4：副詞與組裝", 
                                tags: ["副詞位置"],
                                content: "加上「逐一」(one by one) 修飾整個過程，通常放句尾。", 
                                vocab: ["One by one 逐一"],
                                part: "Magical objects that appeared in sci-fi movies in the past are now becoming reality one by one." 
                            }
                        ],
                        answer: "Magical objects that appeared in sci-fi movies in the past are now becoming reality one by one.",
                        analysis: "典型「形容詞子句」考題。記得把那串落落長的形容詞丟到名詞後面。"
                    }
                ],
                review: [
                    {
                        id: "r1-1",
                        tag: "類題 1",
                        chinese: "互信與溝通是維持良好關係的基石。",
                        hints: { structure: "A and B are the C of D (V-ing)", vocab: ["Mutual trust", "Communication", "Cornerstone / Foundation", "Maintain"] },
                        answer: "Mutual trust and communication are the cornerstones of maintaining good relationships.",
                        analysis: "Step 3 重點：of + V-ing (介系詞片語修飾)。"
                    },
                    {
                        id: "r1-2",
                        tag: "類題 2 (形容詞子句)",
                        chinese: "那些曾經被忽略的傳統技藝，現在正慢慢重新流行。",
                        hints: { structure: "S (that...) + are V-ing + Adv", vocab: ["Traditional crafts", "Ignored / Neglected", "Come back into fashion / Regain popularity"] },
                        answer: "Those traditional crafts that were once ignored are now slowly coming back into fashion.",
                        analysis: "Step 3 重點：Crafts + that were once ignored (形容詞子句)。"
                    }
                ]
            },
            {
                id: "level2",
                title: "第二關：情境與分詞",
                type: "exercise",
                desc: "重點：無靈主詞、轉折語、分詞構句",
                teaching: [
                    {
                        id: "t2-1",
                        chinese: "每逢選舉季節，總會看到政治人物造訪各地著名廟宇。",
                        guide: [
                            { 
                                title: "Step 1：抓出 S + V (改被動)", 
                                tags: ["被動態"],
                                content: "中文沒有主詞，除了補 We，更棒的寫法是把受詞「政治人物」拿到前面當主詞，改成被動態。", 
                                tip: "主動：We see politicians... → 被動：Politicians are seen...",
                                part: "Politicians are always seen..." 
                            },
                            { 
                                title: "Step 2：時態與語態", 
                                tags: ["現在式", "被動語態"],
                                content: "「總會」表示常態，用現在簡單式。結構：be + p.p. (are seen)。", 
                                part: "Politicians are always seen..." 
                            },
                            { 
                                title: "Step 3：補語 (維持分詞)", 
                                tags: ["感官動詞被動"],
                                content: "感官動詞改成被動後，原本的 V-ing (visiting) 維持不變，繼續修飾主詞正在做的動作。", 
                                vocab: ["Politicians 政治人物", "Visit 造訪"],
                                part: "...visiting famous temples..." 
                            },
                            { 
                                title: "Step 4：副詞與組裝", 
                                tags: ["時間地點"],
                                content: "加上時間與地點副詞。「各地」修飾廟宇。", 
                                vocab: ["Election season 選舉季節", "Various places 各地"],
                                part: "During election seasons, politicians are always seen visiting famous temples in various places." 
                            }
                        ],
                        answer: "During election seasons, politicians are always seen visiting famous temples in various places.",
                        analysis: "Step 1 採用被動語態 (S + be seen + Ving) 是避免中式英文「無主詞」的高級技巧。"
                    },
                    {
                        id: "t2-2",
                        chinese: "除了祈求好的選舉結果，他們也希望展現對在地文化與習俗的尊重。",
                        guide: [
                            { 
                                title: "Step 1：抓出 S + V", 
                                tags: ["S+V"],
                                content: "主句的主詞是 They，動詞是 hope to show (希望展現)。", 
                                part: "They also hope to show..." 
                            },
                            { 
                                title: "Step 2：時態與語態", 
                                tags: ["現在式"],
                                content: "表達意願與事實，用現在式。", 
                                part: "They also hope to show..." 
                            },
                            { 
                                title: "Step 3：修飾語 (介系詞片語)", 
                                tags: ["In addition to", "搭配詞"],
                                content: "處理句首的「除了...」。In addition to 是介系詞，後面接 V-ing (praying)。主句受詞是 respect (搭配 for)。", 
                                vocab: ["Pray for 祈求", "Respect for 對...的尊重"],
                                part: "In addition to praying for good election results, ... their respect for local cultures and customs." 
                            },
                            { 
                                title: "Step 4：組裝定稿", 
                                tags: ["完整句"],
                                content: "連接轉折語與主句。", 
                                part: "In addition to praying for good election results, they also hope to show their respect for local cultures and customs." 
                            }
                        ],
                        answer: "In addition to praying for good election results, they also hope to show their respect for local cultures and customs.",
                        analysis: "Step 3 的重點是介系詞片語 (In addition to + Ving) 的運用。"
                    }
                ],
                review: [
                    {
                        id: "r2-1",
                        tag: "類題 1 (被動態練習)",
                        chinese: "每當颱風來襲，總會看到記者在街頭報導。",
                        hints: { structure: "Whenever..., reporters are seen + V-ing...", vocab: ["Typhoon strikes", "Reporters", "Report", "On the streets"] },
                        answer: "Whenever a typhoon strikes, reporters are always seen reporting on the streets.",
                        analysis: "Step 1 重點：改用 Reporters are seen (被動) 取代 We see reporters。"
                    },
                    {
                        id: "r2-2",
                        tag: "類題 2",
                        chinese: "除了發展經濟，政府也必須重視環境保護。",
                        hints: { structure: "In addition to V-ing..., S + V...", vocab: ["Develop economy", "Government", "Attach importance to / Value", "Environmental protection"] },
                        answer: "In addition to developing the economy, the government must also attach importance to environmental protection.",
                        analysis: "Step 3 重點：In addition to developing (介系詞+Ving)。"
                    }
                ]
            },
            {
                id: "level3",
                title: "第三關：名詞子句與高階",
                type: "exercise",
                desc: "重點：名詞子句 (That...)、動名詞主詞、簡化形容詞子句",
                teaching: [
                    {
                        id: "t3-1",
                        chinese: "歷史一再證明，戰爭會造成極為可怕的災難。",
                        guide: [
                            { 
                                title: "Step 1：抓出 S + V", 
                                tags: ["S+V"],
                                content: "主詞是 History，動詞是 prove (證明)。", 
                                part: "History has proven..." 
                            },
                            { 
                                title: "Step 2：時態與語態", 
                                tags: ["現在完成式"],
                                content: "「一再」表示從古至今的經驗累積，用現在完成式 (has proven)。", 
                                vocab: ["Repeatedly / Time and again 一再"],
                                part: "History has proven time and again..." 
                            },
                            { 
                                title: "Step 3：受詞 (名詞子句)", 
                                tags: ["名詞子句"],
                                content: "證明了什麼？證明了「一件事」(戰爭造成災難)。這是一個完整的句子，前面加 that 變成名詞子句當受詞。", 
                                tip: "結構：V + that + [ S + V + O ]",
                                vocab: ["War 戰爭", "Cause 造成", "Devastating disasters 可怕災難"],
                                part: "...that war causes devastating disasters." 
                            },
                            { 
                                title: "Step 4：組裝定稿", 
                                tags: ["完整句"],
                                content: "將主句與名詞子句結合。", 
                                part: "History has proven time and again that war causes devastating disasters." 
                            }
                        ],
                        answer: "History has proven time and again that war causes devastating disasters.",
                        analysis: "這是最經典的「名詞子句」當受詞的用法 (V + that clause)。"
                    },
                    {
                        id: "t3-2",
                        chinese: "避免衝突、確保世界和平應該是所有人類追求的目標。",
                        guide: [
                            { 
                                title: "Step 1：抓出 S + V", 
                                tags: ["動名詞主詞"],
                                content: "主詞是「動作」(避免...確保...)，必須把動詞變名詞 (V-ing)。動詞是 should be。", 
                                vocab: ["Avoid conflicts 避免衝突", "Ensure peace 確保和平"],
                                part: "Avoiding conflicts and ensuring world peace should be..." 
                            },
                            { 
                                title: "Step 2：時態與語態", 
                                tags: ["助動詞"],
                                content: "「應該是」表達期望或義務，用 should be。", 
                                part: "...should be the goal..." 
                            },
                            { 
                                title: "Step 3：修飾語 (簡化形容詞子句)", 
                                tags: ["分詞片語", "形容詞子句簡化"],
                                content: "處理「人類追求的」目標。原本是形容詞子句 (which is pursued by...)，這裡簡化為過去分詞片語。", 
                                tip: "目標是被追求，所以用被動的過去分詞 pursued。",
                                vocab: ["Mankind 人類", "Pursue 追求"],
                                part: "...pursued by all mankind." 
                            },
                            { 
                                title: "Step 4：組裝定稿", 
                                tags: ["完整句"],
                                content: "結合動名詞主詞與後位修飾。", 
                                part: "Avoiding conflicts and ensuring world peace should be the goal pursued by all mankind." 
                            }
                        ],
                        answer: "Avoiding conflicts and ensuring world peace should be the goal pursued by all mankind.",
                        analysis: "Step 3 展示了如何將形容詞子句簡化為分詞片語 (reduced adjective clause)。"
                    }
                ],
                review: [
                    {
                        id: "r3-1",
                        tag: "類題 1 (名詞子句)",
                        chinese: "許多研究證實，規律運動有助於改善心理健康。",
                        hints: { structure: "S + have confirmed + that + S V", vocab: ["Studies", "Confirm / Prove", "Regular exercise", "Improve", "Mental health"] },
                        answer: "Many studies have confirmed that regular exercise helps improve mental health.",
                        analysis: "Step 3 重點：confirmed + that (clause) 名詞子句當受詞。"
                    },
                    {
                        id: "r3-2",
                        tag: "類題 2 (形容詞子句簡化)",
                        chinese: "節約能源、減少浪費是保護地球最簡單的方式。",
                        hints: { structure: "V-ing... and V-ing... are... to V...", vocab: ["Save energy", "Reduce waste", "The simplest way", "Protect the earth"] },
                        answer: "Saving energy and reducing waste are the simplest ways to protect the earth.",
                        analysis: "Step 3 重點：ways + to protect... (不定詞片語當形容詞，修飾 ways)。"
                    }
                ]
            },
            {
                id: "level4",
                title: "第四關：名詞 vs 形容詞子句",
                type: "exercise",
                desc: "終極挑戰：釐清「名詞子句」與「形容詞子句」的差異與用法",
                concept: {
                    title: "核心觀念比一比",
                    items: [
                        {
                            type: "名詞子句 (Noun Clause)",
                            function: "當「名詞」用 (主詞、受詞、補語)",
                            clue: "看前面：通常是「動詞」或在「句首」",
                            example: "I know [that he is right]. (我知道這件事)"
                        },
                        {
                            type: "形容詞子句 (Adj Clause)",
                            function: "當「形容詞」用 (修飾前面的名詞)",
                            clue: "看前面：一定要有「名詞 (先行詞)」",
                            example: "I know the man [who is right]. (我認識那個對的男人)"
                        }
                    ]
                },
                teaching: [
                    {
                        id: "t4-1",
                        chinese: "科學家警告我們，氣候變遷將帶來嚴重後果。(名詞子句)",
                        guide: [
                            { 
                                title: "Step 1：分析主詞與動詞", 
                                tags: ["S+V"],
                                content: "主詞 Scientists，動詞 warn (警告)。", 
                                part: "Scientists warn us..." 
                            },
                            { 
                                title: "Step 2：判斷子句類型", 
                                tags: ["名詞子句"],
                                content: "警告「什麼事情」？warn後面接的是一件「事實」，所以是名詞子句當受詞。", 
                                tip: "warn us (that)... that 可省略",
                                part: "...that climate change will bring serious consequences." 
                            },
                            { 
                                title: "Step 3：組裝", 
                                tags: ["完整句"],
                                content: "前面是動詞 warn，帶出後面的名詞子句。", 
                                vocab: ["Climate change", "Consequences 後果"],
                                part: "Scientists warn us that climate change will bring serious consequences." 
                            }
                        ],
                        answer: "Scientists warn us that climate change will bring serious consequences.",
                        analysis: "這是「名詞子句」，因為整句話是 warn 的受詞。"
                    },
                    {
                        id: "t4-2",
                        chinese: "那些忽略氣候變遷警告的人，將付出代價。(形容詞子句)",
                        guide: [
                            { 
                                title: "Step 1：抓出 S + V", 
                                tags: ["S+V"],
                                content: "主詞是「那些人」(Those people)，動詞是「付出代價」(pay the price)。", 
                                part: "Those people... will pay the price." 
                            },
                            { 
                                title: "Step 2：判斷子句類型", 
                                tags: ["形容詞子句"],
                                content: "哪種人？「忽略警告的」人。這是用來修飾前面的名詞 people，所以是形容詞子句。", 
                                tip: "先行詞是 People，關代用 who",
                                vocab: ["Ignore 忽略", "Warnings 警告"],
                                part: "...who ignore the warnings of climate change..." 
                            },
                            { 
                                title: "Step 3：組裝", 
                                tags: ["插入形容詞子句"],
                                content: "將形容詞子句放入主詞後面。", 
                                part: "Those people who ignore the warnings of climate change will pay the price." 
                            }
                        ],
                        answer: "Those people who ignore the warnings of climate change will pay the price.",
                        analysis: "這是「形容詞子句」，因為它緊跟在名詞 (people) 後面修飾它。"
                    }
                ],
                review: [
                    {
                        id: "r4-1",
                        tag: "混合挑戰",
                        chinese: "我們必須分辨什麼是真實的，以及那些看似真實的謊言。",
                        hints: { 
                            structure: "Distinguish [what is...] (Noun Cl) and [lies which...] (Adj Cl)", 
                            vocab: ["Distinguish 分辨", "True / Real", "Lies 謊言", "Seem / Appear"] 
                        },
                        answer: "We must distinguish what is true and the lies which seem true.",
                        analysis: "第一個是名詞子句(what=the thing which)，第二個是形容詞子句修飾 lies。"
                    },
                    {
                        id: "r4-2",
                        tag: "名詞子句練習",
                        chinese: "我無法理解為什麼他拒絕了這麼好的機會。",
                        hints: { structure: "I cannot understand [why S V...]", vocab: ["Refuse / Turn down", "Opportunity / Offer"] },
                        answer: "I cannot understand why he refused such a good opportunity.",
                        analysis: "Understand 後面接的名詞子句當受詞，疑問詞 why 帶頭。"
                    }
                ]
            }
        ];

        const TeachingCard = ({ question, index }) => {
            const [step, setStep] = useState(0); 
            const maxSteps = question.guide.length;
            const isFinished = step >= maxSteps;
            const scrollRef = useRef(null);

            const nextStep = () => {
                if (step < maxSteps) {
                    setStep(step + 1);
                    setTimeout(() => {
                        if (scrollRef.current) {
                            const children = Array.from(scrollRef.current.children);
                            if (step < children.length) {
                                children[step].scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }
                        }
                    }, 100);
                }
            };

            const reset = () => setStep(0);

            return (
                <div className="bg-white rounded-2xl shadow-lg border border-indigo-50 overflow-hidden mb-10 slide-up transform transition-all hover:shadow-xl">
                    <div className="bg-gradient-to-r from-blue-50 to-indigo-50 p-5 border-b border-indigo-100 flex justify-between items-center">
                        <div className="flex items-center gap-3">
                            <span className="bg-blue-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm shadow-md">
                                {index + 1}
                            </span>
                            <span className="text-blue-900 font-bold text-lg tracking-wide">觀念解析</span>
                        </div>
                        <button onClick={reset} className="text-sm text-blue-500 hover:text-blue-700 font-medium px-3 py-1 rounded-full hover:bg-blue-100 transition-colors">
                            <i className="fas fa-redo-alt mr-1"></i> 重播
                        </button>
                    </div>

                    <div className="p-6 md:p-8">
                        <h3 className="text-2xl font-bold text-gray-800 mb-8 leading-relaxed border-l-4 border-blue-500 pl-4">
                            {question.chinese}
                        </h3>
                        
                        <div className="space-y-0" ref={scrollRef}>
                            {question.guide.map((g, i) => {
                                const isCompleted = step > i; 
                                const isNextActive = step > i + 1; 
                                const isLast = i === question.guide.length - 1;
                                
                                return (
                                    <div key={i} className={`flex transition-all duration-700 ${isCompleted ? 'opacity-100' : 'opacity-40 blur-[1px]'}`}>
                                        
                                        {/* Left Column: Fixed Timeline Layout */}
                                        <div className="flex flex-col items-center mr-4 md:mr-6 w-10 md:w-16 flex-shrink-0">
                                            
                                            {/* Top Connector */}
                                            {i === 0 ? (
                                                <div className="h-4 flex-shrink-0"></div>
                                            ) : (
                                                <div className={`w-1 h-6 transition-colors duration-500 flex-shrink-0 
                                                    ${isCompleted ? 'bg-blue-300' : 'bg-gray-200'}`}></div>
                                            )}

                                            {/* Circle */}
                                            <div className={`w-8 h-8 md:w-10 md:h-10 rounded-full flex items-center justify-center font-bold border-2 md:border-4 transition-all duration-500 z-10 flex-shrink-0
                                                ${isCompleted ? 'bg-blue-600 border-blue-100 text-white shadow-md scale-110' : 'bg-white border-gray-200 text-gray-400'}`}>
                                                {i + 1}
                                            </div>

                                            {/* Bottom Connector */}
                                            {!isLast && (
                                                <div className={`w-1 flex-grow transition-colors duration-500 
                                                    ${isNextActive ? 'bg-blue-300' : 'bg-gray-200'}`}></div>
                                            )}
                                        </div>

                                        {/* Right Column: Content */}
                                        <div className="flex-1 pb-8">
                                            <div className={`bg-white rounded-xl border-2 transition-all duration-500 overflow-hidden
                                                ${isCompleted ? 'border-blue-100 shadow-md' : 'border-transparent'}`}>
                                                
                                                <div className={`px-4 py-2 md:px-5 md:py-3 border-b flex flex-wrap justify-between items-center gap-2 ${isCompleted ? 'bg-blue-50/50 border-blue-100' : 'bg-gray-50 border-gray-100'}`}>
                                                    <h4 className={`font-bold ${isCompleted ? 'text-blue-800' : 'text-gray-500'}`}>{g.title}</h4>
                                                    <div className="flex gap-2">
                                                        {g.tags && g.tags.map((tag, tIdx) => (
                                                            <span key={tIdx} className={`text-xs px-2 py-1 rounded-full font-medium ${isCompleted ? 'bg-blue-100 text-blue-600' : 'bg-gray-200 text-gray-400'}`}>
                                                                #{tag}
                                                            </span>
                                                        ))}
                                                    </div>
                                                </div>

                                                <div className="p-4 md:p-5 space-y-4">
                                                    <p className="text-gray-700 leading-relaxed text-lg break-words">{g.content}</p>
                                                    
                                                    {isCompleted && g.tip && (
                                                        <div className="flex items-start gap-3 bg-yellow-50 p-3 rounded-lg border border-yellow-100 text-sm text-yellow-800 animate-pulse-slow">
                                                            <i className="fas fa-lightbulb mt-1 text-yellow-500 flex-shrink-0"></i>
                                                            <div><span className="font-bold">Teacher's Tip:</span> {g.tip}</div>
                                                        </div>
                                                    )}

                                                    {isCompleted && g.vocab && (
                                                        <div className="flex flex-wrap gap-2 pt-1">
                                                            {g.vocab.map((v, vIdx) => (
                                                                <span key={vIdx} className="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded border border-gray-200">
                                                                    {v}
                                                                </span>
                                                            ))}
                                                        </div>
                                                    )}

                                                    {isCompleted && (
                                                        <div className="mt-2 pt-3 border-t border-gray-100">
                                                            <div className="inline-block bg-blue-600 text-white px-4 py-2 rounded-lg font-mono text-lg shadow-sm break-all">
                                                                {g.part}
                                                            </div>
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                );
                            })}
                        </div>

                        {isFinished && (
                            <div className="mt-6 p-6 bg-green-50 border-2 border-green-200 rounded-2xl fade-in text-center shadow-inner">
                                <p className="text-xs font-bold tracking-widest text-green-600 uppercase mb-2">Complete Sentence</p>
                                <p className="text-xl md:text-2xl font-bold text-green-800 leading-normal font-serif break-words">
                                    {question.answer}
                                </p>
                            </div>
                        )}

                        <div className="mt-8 flex justify-center">
                            {!isFinished ? (
                                <button 
                                    onClick={nextStep}
                                    className="group bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-10 rounded-full shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-1 text-lg flex items-center"
                                >
                                    {step === 0 ? "開始拆解" : "下一步"} 
                                    <i className="fas fa-arrow-down ml-2 group-hover:translate-y-1 transition-transform"></i>
                                </button>
                            ) : (
                                <div className="text-gray-400 font-medium flex items-center bg-gray-100 px-4 py-2 rounded-full">
                                    <i className="fas fa-check-circle text-green-500 mr-2 text-xl"></i> 
                                    解析完成，請嘗試練習模式
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const PracticeCard = ({ question, index, referenceQuestion }) => {
            const [input, setInput] = useState("");
            const [showResult, setShowResult] = useState(false);
            const [showHint, setShowHint] = useState(false);

            return (
                <div className="bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden mb-8 slide-up hover:shadow-lg transition-shadow">
                    <div className="p-4 border-b bg-gradient-to-r from-green-50 to-emerald-50 border-green-100 flex justify-between items-center">
                        <div className="flex items-center gap-3">
                            <span className="px-3 py-1 rounded-full text-xs font-bold bg-green-600 text-white shadow-sm">
                                {question.tag}
                            </span>
                            <span className="text-sm text-green-800 font-bold flex items-center">
                                <i className="fas fa-dumbbell mr-2"></i>結構模仿挑戰
                            </span>
                        </div>
                        <button onClick={() => setShowHint(!showHint)} className="text-sm text-amber-600 hover:text-amber-700 font-medium bg-amber-50 px-3 py-1 rounded-full border border-amber-200 transition-colors">
                            <i className="far fa-lightbulb mr-1"></i> {showHint ? "隱藏提示" : "提示"}
                        </button>
                    </div>
                    
                    <div className="p-6 md:p-8">
                        {referenceQuestion && (
                            <div className="mb-6 p-4 bg-slate-50 border-l-4 border-blue-400 rounded-r-lg text-sm text-slate-600">
                                <div className="flex items-center gap-2 mb-2 text-blue-600 font-bold uppercase tracking-wide text-xs">
                                    <i className="fas fa-history"></i> 觀念回顧 (剛剛學到的句型)
                                </div>
                                <p className="font-medium text-lg text-slate-800">{referenceQuestion.chinese}</p>
                            </div>
                        )}

                        <h3 className="text-xl font-bold text-gray-800 mb-6">{question.chinese}</h3>
                        
                        {showHint && (
                            <div className="mb-6 p-4 bg-amber-50 rounded-xl text-sm text-gray-700 fade-in border border-amber-200 shadow-sm">
                                <div className="flex items-start gap-2 mb-2">
                                    <i className="fas fa-hammer text-amber-500 mt-1"></i>
                                    <p><strong>句型參考：</strong>{question.hints.structure}</p>
                                </div>
                                <div className="flex flex-wrap gap-2 pl-6">
                                    {question.hints.vocab.map((v, i) => (
                                        <span key={i} className="bg-white px-2 py-1 rounded border border-amber-200 text-xs text-gray-600 shadow-sm">{v}</span>
                                    ))}
                                </div>
                            </div>
                        )}

                        <textarea 
                            className="w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-green-100 focus:border-green-500 transition-all mb-4 text-lg text-gray-700 leading-relaxed"
                            rows="3"
                            placeholder="運用剛剛學到的結構試試看..."
                            value={input}
                            onChange={(e) => setInput(e.target.value)}
                        />

                        {!showResult ? (
                            <button 
                                onClick={() => setShowResult(true)}
                                className="w-full py-3 rounded-xl font-bold text-white transition-all bg-gray-800 hover:bg-black shadow-md hover:shadow-lg"
                            >
                                檢查答案
                            </button>
                        ) : (
                            <div className="fade-in bg-green-50 p-6 rounded-xl border border-green-200 mt-2 shadow-inner">
                                <div className="mb-4">
                                    <span className="text-xs font-bold text-green-600 uppercase tracking-wider block mb-1">參考解答</span>
                                    <p className="text-xl font-medium text-green-900 font-serif">{question.answer}</p>
                                </div>
                                <div className="text-sm text-gray-700 border-t border-green-200 pt-3 mt-3 flex items-start gap-2 bg-white/50 p-3 rounded-lg">
                                    <i className="fas fa-info-circle mt-0.5 text-blue-500"></i>
                                    <span>{question.analysis}</span>
                                </div>
                                <div className="mt-4 text-right">
                                    <button onClick={() => setShowResult(false)} className="text-xs text-gray-400 hover:text-gray-600 underline">收起解析</button>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        function App() {
            const [activeTab, setActiveTab] = useState("level1");
            const [mode, setMode] = useState("teaching"); 

            const currentLevel = levels.find(l => l.id === activeTab);

            useEffect(() => {
                setMode("teaching");
                window.scrollTo(0, 0);
            }, [activeTab]);

            return (
                <div className="min-h-screen pb-12 max-w-4xl mx-auto bg-gray-50/50">
                    {/* Header */}
                    <div className="bg-white/95 backdrop-blur-sm pt-8 pb-0 sticky top-0 z-30 shadow-sm border-b border-gray-200">
                        <div className="px-4 mb-6 text-center">
                            <h1 className="text-3xl font-extrabold text-gray-800 tracking-tight">學測翻譯<span className="text-green-600">鷹架訓練營</span></h1>
                            <p className="text-gray-500 text-sm mt-1">Scaffolding Translation Training</p>
                        </div>
                        
                        {/* Tabs */}
                        <div className="flex justify-center px-4 max-w-2xl mx-auto overflow-x-auto no-scrollbar">
                            {levels.map(level => (
                                <button
                                    key={level.id}
                                    onClick={() => setActiveTab(level.id)}
                                    className={`flex-1 pb-4 text-sm md:text-base font-medium transition-all relative whitespace-nowrap px-4 ${activeTab === level.id ? 'tab-active' : 'tab-inactive'}`}
                                >
                                    {level.type === 'grammar' && <i className="fas fa-book mr-2"></i>}
                                    {level.title}
                                </button>
                            ))}
                        </div>
                    </div>

                    <div className="px-4 py-8">
                        {/* Mode Indicator */}
                        <div className="flex justify-center items-center mb-10">
                            <div className={`flex items-center px-6 py-2 rounded-full border ${mode === 'teaching' ? 'bg-white border-blue-200 shadow-sm' : 'bg-transparent border-transparent'}`}>
                                <div className={`w-3 h-3 rounded-full mr-2 ${mode === 'teaching' ? 'bg-blue-500 animate-pulse' : 'bg-gray-300'}`}></div>
                                <span className={`font-bold ${mode === 'teaching' ? 'text-blue-700' : 'text-gray-400'}`}>觀念拆解</span>
                            </div>
                            <div className="w-12 h-0.5 bg-gray-300 mx-2"></div>
                            <div className={`flex items-center px-6 py-2 rounded-full border ${mode === 'practice' ? 'bg-white border-green-200 shadow-sm' : 'bg-transparent border-transparent'}`}>
                                <div className={`w-3 h-3 rounded-full mr-2 ${mode === 'practice' ? 'bg-green-500 animate-pulse' : 'bg-gray-300'}`}></div>
                                <span className={`font-bold ${mode === 'practice' ? 'text-green-700' : 'text-gray-400'}`}>實戰演練</span>
                            </div>
                        </div>

                        {mode === 'teaching' ? (
                            <div className="fade-in max-w-3xl mx-auto">
                                
                                {currentLevel.concept && (
                                    <div className="mb-10 p-6 md:p-8 bg-gradient-to-br from-indigo-50 to-purple-50 rounded-2xl border border-indigo-100 shadow-sm">
                                        <div className="flex items-center gap-3 mb-6">
                                            <div className="bg-indigo-600 text-white p-2 rounded-lg">
                                                <i className="fas fa-balance-scale text-xl"></i>
                                            </div>
                                            <h3 className="font-bold text-indigo-900 text-2xl">{currentLevel.concept.title}</h3>
                                        </div>
                                        <div className="grid md:grid-cols-2 gap-6">
                                            {currentLevel.concept.items.map((item, idx) => (
                                                <div key={idx} className="bg-white p-5 rounded-xl shadow-sm border border-indigo-50 concept-card">
                                                    <div className="text-xs font-bold text-indigo-400 tracking-wider mb-2 uppercase">{item.type}</div>
                                                    <div className="font-bold text-gray-800 text-lg mb-2">{item.function}</div>
                                                    <div className="text-sm bg-yellow-50 text-yellow-800 p-2 rounded mb-3 border border-yellow-100">
                                                        <i className="fas fa-key mr-1"></i> 關鍵：{item.clue}
                                                    </div>
                                                    <div className="text-sm text-gray-500 italic border-l-2 border-gray-300 pl-2">
                                                        {item.example}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                <div className="mb-8 p-4 bg-blue-50 rounded-xl border border-blue-100 flex items-start gap-3">
                                    <div className="bg-blue-100 p-2 rounded-full text-blue-600 flex-shrink-0"><i className="fas fa-info"></i></div>
                                    <div>
                                        <p className="font-bold text-blue-900 text-sm">如何使用教學模式？</p>
                                        <p className="text-sm text-blue-800/80 mt-1">不需要打字。請點擊卡片下方的按鈕，一步步觀察英文句子是如何從中文邏輯中「長」出來的。</p>
                                    </div>
                                </div>
                                
                                {currentLevel.teaching.map((q, idx) => (
                                    <TeachingCard key={q.id} question={q} index={idx} />
                                ))}

                                <div className="text-center py-10 border-t border-gray-200 mt-8">
                                    <p className="text-gray-500 mb-4 font-medium">看懂了解構邏輯嗎？</p>
                                    <button 
                                        onClick={() => { setMode("practice"); window.scrollTo(0, 0); }}
                                        className="bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-12 rounded-full shadow-xl transition-transform transform hover:scale-105 text-lg flex items-center mx-auto"
                                    >
                                        進入練習模式 <i className="fas fa-arrow-right ml-3"></i>
                                    </button>
                                </div>
                            </div>
                        ) : (
                            <div className="fade-in max-w-3xl mx-auto">
                                <div className="mb-8 bg-green-50 border border-green-200 p-5 rounded-xl flex flex-col md:flex-row justify-between items-center gap-4 shadow-sm">
                                    <div className="flex items-start gap-3">
                                        <div className="bg-green-100 p-2 rounded-full text-green-600 mt-1"><i className="fas fa-dumbbell"></i></div>
                                        <div>
                                            <p className="font-bold text-green-900">現在輪到你了！</p>
                                            <p className="text-sm text-green-800">運用剛剛學到的邏輯，試著翻譯下方的「類題」。上方會顯示對應的原句供您參考。</p>
                                        </div>
                                    </div>
                                    <button onClick={() => setMode("teaching")} className="text-sm text-blue-600 hover:text-blue-800 underline font-medium whitespace-nowrap">
                                        <i className="fas fa-history mr-1"></i>回去複習觀念
                                    </button>
                                </div>

                                {currentLevel.review.map((q, idx) => (
                                    <PracticeCard 
                                        key={q.id} 
                                        question={q} 
                                        index={idx} 
                                        referenceQuestion={currentLevel.teaching[idx]} 
                                    />
                                ))}

                                <div className="text-center mt-12 p-8 bg-white rounded-2xl shadow-lg border border-gray-100">
                                    <div className="w-16 h-16 bg-yellow-100 text-yellow-500 rounded-full flex items-center justify-center mx-auto mb-4 text-2xl shadow-sm">
                                        <i className="fas fa-trophy"></i>
                                    </div>
                                    <h3 className="text-xl font-bold text-gray-800">本單元挑戰完成！</h3>
                                    <p className="text-gray-500 mt-2">休息一下，或者點擊上方分頁切換到下一關。</p>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
